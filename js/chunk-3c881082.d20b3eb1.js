(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c881082"],{4546:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("navbar",{staticClass:"navbar"},[a("div",{staticClass:"back",attrs:{slot:"back"},slot:"back"},[a("i",{staticClass:"iconfont iconjiantou2",on:{click:function(e){return t.$router.back()}}})]),a("h4",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("评论")])]),a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.comment,(function(e,n){return a("div",{key:n,staticClass:"comment"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"header"},[a("img",{attrs:{src:t.$axios.defaults.baseURL+e.user.head_img,alt:""}})]),a("div",{staticClass:"text"},[a("h4",[t._v(t._s(e.user.nickname))]),a("div",{staticClass:"content"},[t._v(t._s(e.content))]),a("div",[a("span",{staticClass:"time"},[t._v(t._s(t.moment(e.create_date).fromNow()))]),a("div",{staticClass:"apply",on:{click:function(a){return t.handelreply(e,a)}}},[t._v("回复")])])])]),e.parent?a("commentitem",{attrs:{data:e.parent},on:{reply:t.handelreply}}):t._e()],1)})),0),a("footer",[a("van-field",{ref:"textarea",class:{active:t.myfocus},attrs:{rows:"1",autosize:"",type:"textarea",placeholder:t.reply.user?"回复：@"+t.reply.user.nickname:"请输入留言",autofocus:t.myfocus},on:{focus:t.mfocus,blur:t.mblur,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendmessage(e)}},model:{value:t.message,callback:function(e){t.message="string"===typeof e?e.trim():e},expression:"message"}}),a("div",{staticClass:"button"},[a("button",{on:{click:t.sendmessage}},[t._v("发送")])])],1)],1)},s=[],i=(a("99af"),a("2909")),o=a("9d8d"),c=a("c1df"),r=a.n(c),l=a("dc48");r.a.locale("zh-CN");var d={data:function(){return{token:"",comment:"",moment:r.a,pid:"",loading:!1,finished:!1,pageIndex:1,pageSize:5,message:"",myfocus:!1,reply:{}}},mounted:function(){var t=JSON.parse(localStorage.getItem("user_info")),e=t.token;this.token=e;var a=this.$route.params.id;this.pid=a,this.getcomment()},methods:{onLoad:function(){this.getcomment()},mfocus:function(){this.myfocus=!0},mblur:function(){this.myfocus=!1,""==this.comment.content&&(this.message="")},getcomment:function(){var t=this;this.$axios({url:"/post_comment/".concat(this.pid),methods:"get",params:{pageIndex:this.pageIndex,pageSize:this.pageSize}}).then((function(e){var a=e.data.data;t.comment=[].concat(Object(i["a"])(a),Object(i["a"])(t.comment)),t.pageIndex++,t.loading=!1,a.length<t.pageSize&&(t.finished=!0)})).catch((function(t){console.log(t)}))},sendmessage:function(t){var e=this;if(console.log(t),""!==this.message){var a={content:this.message};this.reply.id&&(a.parent_id=this.reply.id),this.$axios({url:"/post_comment/"+this.pid,method:"POST",headers:{Authorization:this.token},data:a}).then((function(t){e.comment=[],e.pageIndex=1,e.getcomment(),e.reply={},console.log(t),console.log(a)}))}},handelreply:function(t,e){this.reply=t,this.myfocus=!0,this.message="",this.$refs.textarea.focus()}},components:{navbar:o["a"],commentitem:l["a"]}},m=d,u=(a("fc48"),a("2877")),f=Object(u["a"])(m,n,s,!1,null,"39e70966",null);e["default"]=f.exports},"526d":function(t,e,a){},"99af":function(t,e,a){"use strict";var n=a("23e7"),s=a("d039"),i=a("e8b5"),o=a("861d"),c=a("7b0b"),r=a("50c4"),l=a("8418"),d=a("65f0"),m=a("1dde"),u=a("b622"),f=a("2d00"),h=u("isConcatSpreadable"),p=9007199254740991,v="Maximum allowed index exceeded",g=f>=51||!s((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),y=m("concat"),_=function(t){if(!o(t))return!1;var e=t[h];return void 0!==e?!!e:i(t)},k=!g||!y;n({target:"Array",proto:!0,forced:k},{concat:function(t){var e,a,n,s,i,o=c(this),m=d(o,0),u=0;for(e=-1,n=arguments.length;e<n;e++)if(i=-1===e?o:arguments[e],_(i)){if(s=r(i.length),u+s>p)throw TypeError(v);for(a=0;a<s;a++,u++)a in i&&l(m,u,i[a])}else{if(u>=p)throw TypeError(v);l(m,u++,i)}return m.length=u,m}})},ce0c:function(t,e,a){},dc48:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"comment-item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"header"},[a("img",{attrs:{src:t.$axios.defaults.baseURL+t.data.user.head_img,alt:""}})]),a("div",{staticClass:"text"},[a("h4",[t._v(t._s(t.data.user.nickname))]),a("div",{staticClass:"content"},[t._v(t._s(t.data.content))]),a("div",[a("span",{staticClass:"time"},[t._v(t._s(t.moment(t.data.create_date).fromNow()))]),a("div",{staticClass:"apply",on:{click:function(e){return t.myclick(t.data)}}},[t._v("回复")])])])]),t.data.parent?a("commentitem",{attrs:{data:t.data.parent},on:{reply:t.myclick}}):t._e()],1)])},s=[],i=a("c1df"),o=a.n(i),c={name:"commentitem",props:["data"],data:function(){return{moment:o.a}},methods:{myclick:function(t){this.$emit("reply",this.data)}}},r=c,l=(a("dd99"),a("2877")),d=Object(l["a"])(r,n,s,!1,null,"2a68004c",null);e["a"]=d.exports},dd99:function(t,e,a){"use strict";var n=a("ce0c"),s=a.n(n);s.a},fc48:function(t,e,a){"use strict";var n=a("526d"),s=a.n(n);s.a}}]);
//# sourceMappingURL=chunk-3c881082.d20b3eb1.js.map